Initialising login role...
Connecting to remote database...
Skipping migration RLS_EXPLANATION.md... (file name must match pattern "<timestamp>_name.sql")
Skipping migration RLS_TESTING_CHECKLIST.md... (file name must match pattern "<timestamp>_name.sql")
Skipping migration SCHEMA_EXPLANATION.md... (file name must match pattern "<timestamp>_name.sql")
Do you want to push these migrations to the remote database?
 • 001_core_foundation.sql
 • 002_rls_policies.sql
 • 003_academic_structure.sql
 • 004_academic_rls_policies.sql
 • 005_content_structure.sql
 • 006_content_rls_policies.sql
 • 007_lesson_progress.sql
 • 008_lesson_progress_rls.sql
 • 009_assignments_structure.sql
 • 009_storage_bucket.sql
 • 010_assignments_rls.sql
 • 011_attendance_structure.sql
 • 012_attendance_rls.sql
 • 013_certificates_structure.sql
 • 014_certificates_rls.sql
 • 015_dashboard_functions.sql

 [Y/n] y
Applying migration 001_core_foundation.sql...
NOTICE (42710): extension "uuid-ossp" already exists, skipping
Applying migration 002_rls_policies.sql...
Applying migration 003_academic_structure.sql...
Applying migration 004_academic_rls_policies.sql...
Applying migration 005_content_structure.sql...
Applying migration 006_content_rls_policies.sql...
Applying migration 007_lesson_progress.sql...
Applying migration 008_lesson_progress_rls.sql...
ERROR: missing FROM-clause entry for table "old" (SQLSTATE 42P01)                    
At statement: 3                                                                      
-- UPDATE: Students can update their own progress (but not if completed)             
CREATE POLICY "lesson_progress_update_student"                                       
ON lesson_progress                                                                   
FOR UPDATE                                                                           
USING (                                                                              
    is_super_admin()                                                                 
    OR                                                                               
    (has_role('INSTITUTE_ADMIN')                                                     
        AND institute_id = get_user_institute_id())                                  
    OR                                                                               
    -- STUDENT can update their own progress (trigger prevents updating if completed)
    (has_role('STUDENT')                                                             
        AND student_id = auth.uid()                                                  
        AND institute_id = get_user_institute_id())                                  
)                                                                                    
WITH CHECK (                                                                         
    is_super_admin()                                                                 
    OR                                                                               
    (has_role('INSTITUTE_ADMIN')                                                     
        AND institute_id = get_user_institute_id())                                  
    OR                                                                               
    -- STUDENT can update their own progress                                         
    (has_role('STUDENT')                                                             
        AND student_id = auth.uid()                                                  
        AND institute_id = get_user_institute_id()                                   
        -- Prevent updating completed_at directly (trigger will handle it)           
        AND (                                                                        
            -- Can update if not completed                                           
            completed_at IS NULL                                                     
            OR                                                                       
            -- Or if completed_at is being set for the first time                    
            (completed_at IS NOT NULL AND OLD.completed_at IS NULL)                  
        ))                                                                           
)                                                                                    
Try rerunning the command with --debug to troubleshoot the error.
